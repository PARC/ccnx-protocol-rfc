<!DOCTYPE html>
<html>

  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width initial-scale=1" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

    <title>CCNx Semantics</title>
    <meta name="description" content="CCNx Protocol Specifications">

    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.2.0/jquery.js"></script>

    <!-- Latest compiled and minified CSS -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css" integrity="sha384-1q8mTJOASx8j1Au+a5WDVnPi2lkFfwwEAa8hDDdjZlpLegxhjVME1fgjWPGmkzs7" crossorigin="anonymous">

    <!-- Optional theme -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap-theme.min.css" integrity="sha384-fLW2N01lMqjakBkx3l/M9EahuwpSfeNvV63J5ezn3uZzapT0u7EYsXMjQV+0En5r" crossorigin="anonymous">

    <!-- Latest compiled and minified JavaScript -->
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js" integrity="sha384-0mSbJDEHialfmuBBQP6A4Qrprq5OVfW37PRR3j5ELqxss1yVqOtnepnHVP9aJ7xS" crossorigin="anonymous"></script>

    <link rel="stylesheet" href="/ccnx-spec//css/main.css">
    <link rel="canonical" href="ccnx.org/ccnx-spec//documents/semantics.html">

    <style>
            td.RFCbug {
                    font-size: x-small; text-decoration: none;
                    width: 30px; height: 30px; padding-top: 2px;
                    text-align: justify; vertical-align: middle;
                    background-color: #000;
            }
            td.RFCbug span.RFC {
                    font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                    font-weight: bold; color: #666;
            }
            td.RFCbug span.hotText {
                    font-family: charcoal, monaco, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                    font-weight: normal; text-align: center; color: #FFF;
            }

            table.TOCbug { width: 30px; height: 15px; }
            td.TOCbug {
                    text-align: center; width: 30px; height: 15px;
                    color: #FFF; background-color: #900;
            }
            td.TOCbug a {
                    font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, sans-serif;
                    font-weight: bold; font-size: x-small; text-decoration: none;
                    color: #FFF; background-color: transparent;
            }

            td.header {
                    font-family: arial, helvetica, sans-serif; font-size: x-small;
                    vertical-align: top; width: 33%;
                    color: #FFF; background-color: #666;
            }
            td.author { font-weight: bold; font-size: x-small; margin-left: 4em; }
            td.author-text { font-size: x-small; }

            /* info code from SantaKlauss at http://www.madaboutstyle.com/tooltip2.html */
            a.info {
                    /* This is the key. */
                    position: relative;
                    z-index: 24;
                    text-decoration: none;
            }
            a.info:hover {
                    z-index: 25;
                    color: #FFF; background-color: #900;
            }
            a.info span { display: none; }
            a.info:hover span.info {
                    /* The span will display just on :hover state. */
                    display: block;
                    position: absolute;
                    font-size: smaller;
                    top: 2em; left: -5em; width: 15em;
                    padding: 2px; border: 1px solid #333;
                    color: #900; background-color: #EEE;
                    text-align: left;
            }

            a { font-weight: bold; }
            a.info:link    { color: #900; background-color: transparent; }
            a.info:visited { color: #633; background-color: transparent; }
            a.info:active  { color: #633; background-color: transparent; }

            p { margin-left: 2em; margin-right: 2em; }
            p.copyright { font-size: x-small; }
            p.toc { font-size: small; font-weight: bold; margin-left: 3em; }
            table.toc { margin: 0 0 0 3em; padding: 0; border: 0; vertical-align: text-top; }
            td.toc { font-size: small; font-weight: bold; vertical-align: text-top; }

            ol.text { margin-left: 2em; margin-right: 2em; }
            ul.text { margin-left: 2em; margin-right: 2em; }
            .rfc-text li      { margin-left: 3em; }

            /* RFC-2629 <spanx>s and <artwork>s. */
            em     { font-style: italic; }
            strong { font-weight: bold; }
            dfn    { font-weight: bold; font-style: normal; }
            cite   { font-weight: normal; font-style: normal; }
            tt     { color: #036; }
            tt, pre, pre dfn, pre em, pre cite, pre span {
                    font-family: "Courier New", Courier, monospace; font-size: small;
            }
            pre {
                    text-align: left; padding: 4px;
                    color: #000; background-color: #CCC;
            }
            pre dfn  { color: #900; }
            pre em   { color: #66F; background-color: #FFC; font-weight: normal; }
            pre .key { color: #33C; font-weight: bold; }
            pre .id  { color: #900; }
            pre .str { color: #000; background-color: #CFF; }
            pre .val { color: #066; }
            pre .rep { color: #909; }
            pre .oth { color: #000; background-color: #FCF; }
            pre .err { background-color: #FCC; }

            /* RFC-2629 <texttable>s. */
            table.all, table.full, table.headers, table.none {
                    font-size: small; text-align: center; border-width: 2px;
                    vertical-align: top; border-collapse: collapse;
            }
            table.all, table.full { border-style: solid; border-color: black; }
            table.headers, table.none { border-style: none; }
            th {
                    font-weight: bold; border-color: black;
                    border-width: 2px 2px 3px 2px;
            }
            table.all th, table.full th { border-style: solid; }
            table.headers th { border-style: none none solid none; }
            table.none th { border-style: none; }
            table.all td {
                    border-style: solid; border-color: #333;
                    border-width: 1px 2px;
            }
            table.full td, table.headers td, table.none td { border-style: none; }

            hr { height: 1px; }
            hr.insert {
                    width: 80%; border-style: none; border-width: 0;
                    color: #CCC; background-color: #CCC;
            }
    </style>
</head>


  <body>

    <header class="site-header">

  <!-- <div class="wrapper"> -->

    <!-- <a class="site-title" href="/ccnx-spec//">CCNx Protocol</a> -->

    <!-- <nav class="site-nav">
      <a href="#" class="menu-icon">
        <svg viewBox="0 0 18 15">
          <path fill="#424242" d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.031C17.335,0,18,0.665,18,1.484L18,1.484z"/>
          <path fill="#424242" d="M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0c0-0.82,0.665-1.484,1.484-1.484 h15.031C17.335,6.031,18,6.696,18,7.516L18,7.516z"/>
          <path fill="#424242" d="M18,13.516C18,14.335,17.335,15,16.516,15H1.484C0.665,15,0,14.335,0,13.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.031C17.335,12.031,18,12.696,18,13.516L18,13.516z"/>
        </svg>
      </a> -->

      <!-- <div class="trigger">
        
          
          <a class="page-link" href="/ccnx-spec//community/">Community</a>
          
        
          
        
          
          <a class="page-link" href="/ccnx-spec//implementations.html">CCNx Protocol Implementations</a>
          
        
          
        
          
        
          
          <a class="page-link" href="/ccnx-spec//community/meetings/meeting_01062016.html">January 6, 2016</a>
          
        
          
          <a class="page-link" href="/ccnx-spec//community/meetings/meeting_01202016.html">January 20, 2016</a>
          
        
          
          <a class="page-link" href="/ccnx-spec//community/meetings/meeting_02032016.html">February 3, 2016</a>
          
        
          
          <a class="page-link" href="/ccnx-spec//community/meetings/meeting_03022016.html">March 2nd, 2016</a>
          
        
          
          <a class="page-link" href="/ccnx-spec//community/meetings/meeting_03162016.html">March 16, 2016</a>
          
        
          
          <a class="page-link" href="/ccnx-spec//community/meetings/meeting_03302016.html">March 30, 2016</a>
          
        
          
          <a class="page-link" href="/ccnx-spec//community/meetings/meeting_04162016.html">April 16, 2016</a>
          
        
          
          <a class="page-link" href="/ccnx-spec//community/meetings/meeting_10212015.html">October 21, 2015</a>
          
        
          
          <a class="page-link" href="/ccnx-spec//community/meetings/meeting_10282015.html">October 28, 2015</a>
          
        
          
          <a class="page-link" href="/ccnx-spec//community/meetings/meeting_11112015.html">November 11, 2015</a>
          
        
          
          <a class="page-link" href="/ccnx-spec//community/meetings/meeting_11252015.html">November 25, 2015</a>
          
        
          
          <a class="page-link" href="/ccnx-spec//community/meetings/meeting_12092015.html">December 9, 2015</a>
          
        
          
          <a class="page-link" href="/ccnx-spec//community/meetings/meeting_12232015.html">December 23, 2015</a>
          
        
          
          <a class="page-link" href="/ccnx-spec//documents/messages.html">CCNx Messages in TLV Format</a>
          
        
          
          <a class="page-link" href="/ccnx-spec//documents/names.html">CCNx URI Scheme</a>
          
        
          
          <a class="page-link" href="/ccnx-spec//publications.html">Related CCNx Papers and Technical Reports</a>
          
        
          
          <a class="page-link" href="/ccnx-spec//documents/semantics.html">CCNx Semantics</a>
          
        
          
          <a class="page-link" href="/ccnx-spec//community/twg.html">CCNx Technical Working Group</a>
          
        
      </div> -->

      <nav class="navbar navbar-inverse navbar-fixed-top">
          <div class="container-fluid">
          <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1" aria-expanded="false">
              <span class="sr-only">Toggle navigation</span>
              <span class="icon-bar"></span>
              <span class="icon-bar"></span>
              <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="/ccnx-spec">CCNx</a>
          </div>

      <div class="collapse navbar-collapse">
          <ul class="nav navbar-nav">
              <!-- <ul class="nav nav-pills nav-stacked"> -->
              <li class="dropdown">
                  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Documents <span class="caret"></span></a>
                  <ul class="dropdown-menu">
                      <li style="margin: 10px;"><em>Core Protocol</em></li>
                      <li style="margin: 10px;"><a href="/ccnx-spec/documents/messages.html">CCNx Messages in TLV Format</a></li>
                      <li style="margin: 10px;"><a href="/ccnx-spec/documents/semantics.html">CCNx Semantics</a></li>
                      <li style="margin: 10px;"><a href="/ccnx-spec/documents/names.html">CCNx URI Scheme</a></li>

                      <!-- <li role="separator" class="divider"></li> -->
                      <!-- <li style="margin: 10px;"><em>Others</em></li> -->
                      <!-- <li style="margin: 10px;"><a href="#" data-toggle="tab" data-target="#">Others</a></li> -->
                  </ul>
              </li>

              <li><a href="/ccnx-spec/implementations.html">Implementations</a></li>
              <li><a href="/ccnx-spec/publications.html">Publications</a></li>
              <li class="dropdown">
                <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Participate <span class="caret"></span></a>
                <ul class="dropdown-menu">
                  <li style="margin: 10px;"><a href="http://trac.tools.ietf.org/group/irtf/trac/wiki/icnrg">ICNRG IRTF Working Group</a></li>
                  <li style="margin: 10px;"><a href="/ccnx-spec/community/twg.html">CCNx Technical Working Group</a></li>
                  <li role="separator" class="divider"></li>
                  <li style="margin: 10px;"><a href="https://www.ccnx.org/mailman/listinfo/ccnx/">CCNx Mailing list</a></li>
                  <li style="margin: 10px;"><a href="https://www.ccnx.org/mailman/listinfo/ccnx-announce/">CCNx Announcement Mailing list</a></li>
                </ul>
              </li>
            </ul>
            <!-- <form class="navbar-form navbar-left" role="search">
              <div class="form-group">
                <input type="text" class="form-control" placeholder="Search the document...">
              </div>
            </form> -->
        </div><!-- /.navbar-collapse -->
    </div>
    </nav>

  <!-- </div> -->

</header>


    <div style="margin-top:50px">
        <div class="document">
  <div class="container">
      <!-- <header class="document-header">
        <h1 class="document-title">CCNx Semantics</h1>
      </header> -->

      <div class="col-md-4">
  <div class='wrapper text-center'>
      <h2>Downloads</h2>
      <div class="btn-group-vertical">
          <button type="button" class="btn" style="margin:10px;"><a href="https://github.com/PARC/ccnx-messages/raw/master/draft-irtf-icnrg-ccnxsemantics-01.pdf" role="button">Download PDF</a></button>
          <button type="button" class="btn" style="margin:10px;"><a href="https://github.com/PARC/ccnx-messages/raw/master/draft-irtf-icnrg-ccnxsemantics-01.txt" role="button">Download TXT</a></button>
          <button type="button" class="btn" style="margin:10px;"><a href="https://github.com/PARC/ccnx-semantics" role="button">View on GitHub</a></button>
      </div>
      <hr/>
  </div>
  <br/>
  <div class='wrapper text-center'>
    <h2 id="toc">Table of Contents</h2>
  </div>
  <p class="toc">
<a href="#anchor1">1.</a>&nbsp;
Introduction<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor2">1.1.</a>&nbsp;
Requirements Language<br />
<a href="#named_payload">2.</a>&nbsp;
Named Payload<br />
<a href="#names">3.</a>&nbsp;
Names<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#NameExamples">3.1.</a>&nbsp;
Name Examples<br />
<a href="#Interest">4.</a>&nbsp;
Interests<br />
<a href="#object">5.</a>&nbsp;
Content Objects<br />
<a href="#link">6.</a>&nbsp;
Link<br />
<a href="#hashes">7.</a>&nbsp;
Hashes<br />
<a href="#signature">8.</a>&nbsp;
Validation<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#valalg">8.1.</a>&nbsp;
Validation Algorithm<br />
<a href="#matching">9.</a>&nbsp;
Interest to Content Object matching<br />
<a href="#behavior">10.</a>&nbsp;
Request/Response Protocol<br />
<a href="#anchor3">11.</a>&nbsp;
Interest Return<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#MessageFormat">11.1.</a>&nbsp;
Message Format<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#TypeDefinitions">11.2.</a>&nbsp;
ReturnCode Types<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#Protocol">11.3.</a>&nbsp;
Interest Return Protocol<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#NoRoute">11.3.1.</a>&nbsp;
No Route<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#HopLimit">11.3.2.</a>&nbsp;
HopLimit Exceeded<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#MTU">11.3.3.</a>&nbsp;
Interest MTU Too Large<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#NoResources">11.3.4.</a>&nbsp;
No Resources<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#PathError">11.3.5.</a>&nbsp;
Path Error<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#Prohibited">11.3.6.</a>&nbsp;
Prohibited<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#Congestion">11.3.7.</a>&nbsp;
Congestion<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#UnsupportedHashAlgorithm">11.3.8.</a>&nbsp;
Unsupported Content Object Hash Algorithm<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#MalformedInterest">11.3.9.</a>&nbsp;
Malformed Interest<br />
<a href="#Acknowledgements">12.</a>&nbsp;
Acknowledgements<br />
<a href="#IANA">13.</a>&nbsp;
IANA Considerations<br />
<a href="#Security">14.</a>&nbsp;
Security Considerations<br />
<a href="#rfc.references1">15.</a>&nbsp;
References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references1">15.1.</a>&nbsp;
Normative References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references2">15.2.</a>&nbsp;
Informative References<br />
<a href="#rfc.authors">&#167;</a>&nbsp;
Authors' Addresses<br />
</p>
<br clear="all" />

  <br clear="all" />
</div>

<div class="col-md-8 rfc-text">
  <ol class="breadcrumb">
      <li>Documents</li>
      <li>Core Protocol</li>
      <li>CCNx Semantics</li>
  </ol>

  <table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<table summary="layout" width="66%" border="0" cellpadding="0" cellspacing="0"><tr><td><table summary="layout" width="100%" border="0" cellpadding="2" cellspacing="1">
<tr><td class="header">ICNRG</td><td class="header">M. Mosko</td></tr>
<tr><td class="header">Internet-Draft</td><td class="header">I. Solis</td></tr>
<tr><td class="header">Intended status: Experimental</td><td class="header">C. Wood</td></tr>
<tr><td class="header">Expires: September 15, 2016</td><td class="header">PARC, Inc.</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">March 14, 2016</td></tr>
</table></td></tr></table>
<h1><br />CCNx Semantics<br />draft-irtf-icnrg-ccnxsemantics-01</h1>

<h3>Abstract</h3>

<p>This document describes the core concepts of the CCNx architecture and presents
        a minimum network protocol based on two messages: Interest and Content Object.
      It specifies the set of mandatory and optional fields within those messages
      and describes their behavior and interpretation. This architecture and protocol
      specification is independent of a specific wire encoding.
</p>
<p>The protocol also uses a Control message called an InterestReturn, whereby
      one system can return an Interest message to the previous hop due to an
      error condition.  It indicates to the previous hop that the current system will
      not respond to the Interest.
</p>
<h3>Status of this Memo</h3>
<p>
This Internet-Draft is submitted  in full
conformance with the provisions of BCP&nbsp;78 and BCP&nbsp;79.</p>
<p>
Internet-Drafts are working documents of the Internet Engineering
Task Force (IETF).  Note that other groups may also distribute
working documents as Internet-Drafts.  The list of current
Internet-Drafts is at http://datatracker.ietf.org/drafts/current/.</p>
<p>
Internet-Drafts are draft documents valid for a maximum of six months
and may be updated, replaced, or obsoleted by other documents at any time.
It is inappropriate to use Internet-Drafts as reference material or to cite
them other than as &ldquo;work in progress.&rdquo;</p>
<p>
This Internet-Draft will expire on September 15, 2016.</p>

<h3>Copyright Notice</h3>
<p>
Copyright (c) 2016 IETF Trust and the persons identified as the
document authors.  All rights reserved.</p>
<p>
This document is subject to BCP 78 and the IETF Trust's Legal
Provisions Relating to IETF Documents
(http://trustee.ietf.org/license-info) in effect on the date of
publication of this document.  Please review these documents
carefully, as they describe your rights and restrictions with respect
to this document. Code Components extracted from this document must
include Simplified BSD License text as described in Section 4.e of
the Trust Legal Provisions and are provided without warranty as
described in the Simplified BSD License.</p>

  <a name="anchor1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1"></a><h3>1.&nbsp;
Introduction</h3>

<p>This document describes the principles of the CCNx architecture. It describes the network protocol
         based on two message types: Interests and Content Objects.  The description is not
       dependent on a specific wire format or particular encodings.
</p>
<p>CCNx uses subjective names to identify bytes of payload.
          The Name combines a routable prefix with an arbitrary suffix assigned by the publisher to a piece of content.
          The result is a "named payload".
          This is different from other systems that use only self-certifying names, where the payload name is intrinsically
         derivable from the payload or its realization in a network object
         (e.g. a SHA-256 hash of the payload or
         network object).
</p>
<p>The key concept of CCNx is that a subjective name is bound to a fixed payload via
         cryptographic operations. This implies that the fact that a given publisher bound a certain subjective name to a certain
         payload can be verified via cryptographic means. For example, a publisher could
         use a cryptographic hash over the name and
       payload, sign the hash, and deliver the tuple {Name, Payload, Validation}.
       Additional information would be included as needed by different
       validation mechanisms are used.  A typical named payload is thus {Name, Payload, ValidationAlgorithm}.

</p>
<p>CCNx specifies a network protocol around Interests (request messages) and Content Objects
       (response messages) to move named payloads.  An Interest
       includes the Name, the desired payload, and two optional restrictions to limit responses
       to a specific publisher or a specific Content Object. The Content Object response carries
       a matching Name and the specified payload.
       Matching a Content Object to an Interest is an exact match on the Name.
       The CCNx network protocol of Interests and
       Content Objects imposes a restriction on Names: each Name should be hierarchical
       and is used to route towards an authoritative source.
       The CCNx Name looks like a URI absolute path and
       we use URI terminology to describe CCN Names as made up of
       name segments.  In practice it has a binary encoding, not a text string.
</p>
<p>The hierarchy of a CCNx Name is used for routing via the longest matching
       prefix in a Forwarder.  The longest matching prefix is computed name segment by
       name segment in the hierarchical path name, where each name segment must
       be exactly equal to match.
       There is no requirement that the prefix be globally routable.  Within
       a deployment any local routing may be used, even one that only uses
       a single flat (non-hierarchical) name segment.
       Some Forwarders may use more advanced matching
       rules that allow both longest matching prefix and shorter prefixes.

</p>
<p>Another central concept of CCNx is that there should be flow balance
          between Interest messages and Content Object messages.  At the network level,
          an Interest traveling along a single path should elicit no more than one
          Content Object response.  If some node sends the Interest along more than one
          path, that node should consolidate the responses such that only one
          Content Object flows upstream from it to the requester.
</p>
<p>There are additional optional attributes in an
          Interest message that can be used to select between multiple Content Objects with
          matching Names (it is possible that multiple publishers could
          issue Content Objects with the same Name).
          An Interest may carry an optional KeyIdRestriction and / or
          an optional ContentObjectHashRestriction. If either or both of these are present, a Forwarder
          must ensure that they exactly match the corresponding KeyId and computed ContentObjectHash in the Content Object.

</p>
<p>As an Interest travels the forward path following the Forwarding Information
       Base (FIB), it leaves behind state at each Forwarder.  This state
       is stored in the Pending Interest Table (PIT), which tracks the ingress and egress
       ports as well as
       the Name, KeyIdRestriction (if one exists), and ContentObjectHashRestriction (if one exists) of each Interest.
       When a Content Object
       arrives at the node, it is exactly matched against that tuple to see if it satisfies any
       Interests in the PIT.  If it does, it is returned along the matching Interest's reverse path.
       If it does not, the Content Object is dropped.

</p>
<p>If multiple Interests with the same tuple {Name, KeyIdRestriction, ContentObjectHashRestriction}
        arrive at a node before a Content Object matching the first Interest comes back,
        they are
        grouped in the same PIT entry and their reverse paths aggregated.  Thus,
        one Content Object might satisfy multiple pending Interests.
</p>
<p>In CCNx, higher-layer protocols often become so-called "name-based protocols" because
       they operate on the CCNx Name.  For example, a versioning protocol might append additional
       name segments to convey state about the version of payload.  A content discovery protocol
       might append certain protocol-specific name segments to a prefix to discover content
       under that prefix.  Many such protocols may exist and apply their own rules to
       Names. They may be layered with each protocol encapsulating (to the left) a higher layer's Name prefix.
</p>
<p>This document also describes a control message called an InterestReturn.
          A network element may return an Interest message
          to a previous hop if there is an error processing the Interest. The returned Interest may be
          further processed at the previous hop or returned towards the Interest origin.
          When a node returns an Interest it indicates that the previous hop should not expect a response
          from that node for the Interest -- i.e. there is no PIT entry left at the returning node for
          a Content Object to follow.
</p>
<p>There are multiple ways to describe larger objects in CCNx.  Some options may use the namespace while
          others may use a structure such as a Manifest.  This document does not address these options at this time.
</p>
<p>The remainder of this document describes a named payload, and the Interest/Content Object
      network protocol behavior in detail.
</p>
<p>TODO -- we have not adopted the Requirements Language yet.
</p>
<a name="anchor2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1.1"></a><h3>1.1.&nbsp;
Requirements Language</h3>

<p>The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT", "SHOULD", "SHOULD
          NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this document are to be interpreted as
          described in <a class='info' href='#RFC2119'>RFC 2119<span> (</span><span class='info'>Bradner, S., &ldquo;Key words for use in RFCs to Indicate Requirement Levels,&rdquo; March&nbsp;1997.</span><span>)</span></a> [RFC2119].
</p>
<a name="named_payload"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2"></a><h3>2.&nbsp;
Named Payload</h3>

<p>CCNx supports several cryptographic means to bind a Name to a payload.  Interest and Content Object messages
        include a section called the ValidationAlgorithm, which specifies the algorithm
        to use to verify the binding.  Several validation algorithms
        are supported including specific Message Integrity Checks (MICs), Message Authentication
        Codes (MACs), and Signature types. These are over specific wire format encodings.
        Additional
        schemes could be added in the future. Interest and Content Object messages also include a section called the ValidationPayload which
        contains the validation output.
</p>
<p>The KeyId is an optional field in the ValidationAlgorithm.  It is an octet string that identifies the key used to sign the
        Content Object.  It uniquely identifies the publisher. It is similar to a Subject Key
        Identifier from X509 [RFC 3280, Section 4.2.1.2].
        It should be derived from the key used to sign, for example SHA-256 hash of the key.  It
        applies to both public/private key systems and to symmetric key systems using HMAC.
</p>
<p>A PublicKeyLocator is an optional field in the ValidationAlgorithm.  It may be one of (a) the signer's public key, (b) the signer's certificate,
        or (c) a KeyName that points to the location of the signer's key or certificate.
</p>
<p>A Key inside a PublicKeyLocator is a public key corresponding to the signer's private key.  Examples
        would be PEM or DER encodings.  The exact encoding is up to the wire format.
</p>
<p>A Certificate is an X.509 certificate of the signer's public key.  Examples would be PEM or
        DER encodings of the certificate.  The exact encoding is up to the wire format.
</p>
<p>A KeyName is a CCNx Name and optional signer's KeyId of that name's publisher.
        The CCNx Name points to a Key or Certificate.  The KeyName signer KeyId is of the signer of the
        target name's Content Object, not of the target key or certificate.
</p>
<p>A SignatureTime is an optional field in the ValidationAlgorithm.  It may be used as part of the signature validation check to ensure
        the signature was generated around the expected time.  In particular, if the public key is conveyed in a certificate with a validity period,
      the verifying system may enforce that the signature came from a corresponding period.  Some verifiers might determine a signature without
      a SignatureTime to be invalid.
</p>
<a name="names"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3"></a><h3>3.&nbsp;
Names</h3>

<p>A CCNx name is a composition of name segments. Each name segment carries a label
      identifying the purpose of the name segment, and a value.  For example, some
      name segments are general names and some serve specific purposes, such as carrying
      version information or the sequencing of many chunks of a large object into smaller,
      signed Content Objects.
</p>
<p>The name segment labels specified in this document are given in the table below.
        Name Segment is a general name segment, typically occurring in the
        routable prefix and user-specified content name.  Other segment types are for
        functional name components that imply a specific purpose.

</p>
<p>A forwarding table entry may contain name segments of any type.
         Routing protocol policy and local system policy may limit what goes into
         forwarding entries, but there is no restriction at the core level.
         An Interest routing protocol, for example, may only allow binary name segments.
         A load balancer or compute cluster
          may route through additional component types, depending on their services.

</p><br /><hr class="insert" />
<a name="name_types"></a>
<table class="full" align="center" border="0" cellpadding="2" cellspacing="2">
<col align="center"><col align="left">
<tr><th align="center">Name</th><th align="left">Description</th></tr>
<tr>
<td align="center">Name Segment</td>
<td align="left">A generic name segment that includes arbitrary octets.</td>
</tr>
<tr>
<td align="center">Interest Payload ID</td>
<td align="left">An octet string that identifies the payload carried in an Interest. As an example, the Payload ID might be a hash of the Interest Payload.
          This provides a way to differentiate between Interests based on the Payload solely through a Name Segment without having to include
          all the extra bytes of the payload itself. </td>
</tr>
<tr>
<td align="center">Application Components</td>
<td align="left">An application-specific payload in a name segment.  An application may apply
          its own semantics to these components.  A good practice is to identify the
        application in a Name segment prior to the application component segments.</td>
</tr>
</table>
<br clear="all" />
<table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Table 1: CCNx Name Segment Types&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<p>At the lowest level, a Forwarder does not need to understand the semantics
      of name segments; it need only identify name segment boundaries and
      be able to compare two name segments (both label and value) for equality.  The Forwarder
      matches paths segment-by-segment against
      its forwarding table to determine a next hop.
</p>
<a name="NameExamples"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.1"></a><h3>3.1.&nbsp;
Name Examples</h3>

<p>This section uses the <a class='info' href='#CCNxURI'>CCNx URI<span> (</span><span class='info'>Mosko, M. and C. Wood, &ldquo;The CCNx URI Scheme (Internet draft),&rdquo; 2016.</span><span>)</span></a> [CCNxURI] representation of CCNx names .
</p><br /><hr class="insert" />
<a name="name_examples"></a>
<table class="full" align="center" border="0" cellpadding="2" cellspacing="2">
<col align="center"><col align="left">
<tr><th align="center">Name</th><th align="left">Description</th></tr>
<tr>
<td align="center">ccnx:/</td>
<td align="left">A 0-length name, corresponds to a default route.</td>
</tr>
<tr>
<td align="center">ccnx:/NAME=</td>
<td align="left">A name with 1 segment of 0 length, distinct from ccnx:/.</td>
</tr>
<tr>
<td align="center">ccnx:/NAME=foo/APP:0=bar</td>
<td align="left">A 2-segment name, where the first segment is of type NAME and the second
           segment is of type APP:0.</td>
</tr>
</table>
<br clear="all" />
<table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Table 2: CCNx Name Examples&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<a name="Interest"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4"></a><h3>4.&nbsp;
Interests</h3>

<p>An Interest is composed of the tuple {Name, Metadata, Payload, Validator}.
        These fields are defined below.  Only the Name is mandatory. Other fields, if missing, should be
        interpreted as "do not care".
</p>
<p>Name is a hierarchical path that identifies the resource.  It is matched as described above.
</p>
<p>An Interest may also have a Payload which carries state about the Interest but is not used to match a Content Object.
        If an Interest contains a payload, the Interest name should contain an Interest Payload ID (IPID).
        The IPID allows a PIT table entry to correctly multiplex Content Objects in response to a specific Interest with
        a specific payload ID.  The IPID could be derived from a hash of the payload or could be a GUID or a nonce.
        An optional Metadata field defines the IPID field so other systems could verify the IPID, such as when it is
        derived from a hash of the payload.  No system is required to verify the IPID.

</p>
<p>An Interest may contain Validation fields including a ValidationAlgorithm section describing the type of
        validator to use and the ValidationPayload fields containing the output of the validation. Typically this would
        only be a MIC - a crc, checksum, or digest.
</p>
<p>An Interest contains additional fields with information about the query. Two fields - the
        KeyIdRestriction and ContentObjectHashRestriction - serve as
        selectors to help identify the specific Content Object that should be returned.
</p>
<p>The Interest Lifetime element specifies the maximum number of milliseconds a Forwarder
        should retain the Interest in its PIT.  A lifetime of "0" means the requester does not expect a
        response from the Interest - it serves as a type of notification.
        The lifetime is only a guideline for a Forwarder, which may keep an Interest for a
        shorter or longer time, based on local conditions and system policy. It may change hop to hop
        if the Interest is delayed for any signifiant amount of time. It is measured in millisecond
        resolution, so in fast switching it normally would not need to change.
        This field does not affect the matching of Content Objects.

</p>
<p>The Interest HopLimit element is a counter that is decremented with each hop. It limits the
        distance an Interest may travel.  The node originating the
        Interest may put in any value - up to the maximum - in
        network byte order.  Each node that receives
        an Interest with a HopLimit decrements the value upon
        reception.  If the value is 0 after the decrement, the Interest
        cannot be forwarded off the node. The PIT entry should also track the maximum HopLimit forwarded.  If
          an Interest with a longer HopLimit arrives, it should be forwarded
          even if it is identical to a previously forwarded Interest.

</p>
<p> Interest looping is not prevented in CCNx. An Interest traversing loops is eventually discarded using the hop-limit field of the Interest, which is decremented at each hop traversed by the Interest.  Other implementations may define additional optional headers, for example Nonces for loop detection,
        headers for Differentiated Services Code Points (DSCP), or Flow Labels.
</p>
<a name="object"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5"></a><h3>5.&nbsp;
Content Objects</h3>

<p>A Content Object is composed of the same tuple as an Interest: {Name, Metadata, Payload, Validator}.

</p>
<p>The Name is an optional field that identifies the contents.  If the name does not exist, then
      the ContentObject can only be matched by a ContentObjectHashRestriction.
</p>
<p>The Payload of a Content Object holds the upper layer payload.  It may be encrypted, based
        on outside information or a protocol information header.
</p>
<p>The optional Metadata PayloadType field identifies the type of Content Object: "DATA" implies an opaque payload;
        "LINK" is a Content Object with an encoded Link as a payload. "DATA" is the default.
</p>
<p>The optional field ExpiryTime is a millisecond timestamp containing
        the number of milliseconds since the epoch in UTC
        of when the contents will expire. If it is not present, there is no expiration on the Content Object.
        The ExpiryTime should be part of the signed information covered by the Validator, if present.
</p>
<p>A publisher or upstream node may include a Recommended Cache Time for Content Objects. It is represented as
        the number of milliseconds since the epoch in UTC as the desired minimum time to keep the content object in cache.
        This recommendation is a guideline as to the useful lifetime of a Content Object, but may be ignored.
        The RecommendedCacheTime should not be covered by
        the Validator, if present, as nodes may change the value based on their caching.
        The ExpiryTime takes precedence over the RecommendedCacheTime, if both exist.
</p>
<p>
        Other protocols, such as versioning or chunking, could place other kinds of metadata in the Content Object.

</p>
<a name="link"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6"></a><h3>6.&nbsp;
Link</h3>

<p>A Link is the tuple {Name, KeyId, ContentObjectHashRestriction}.  The information in a Link comprises the fields
        the fields of an Interest which would retrieve the Link target.
        A Content Object with PayloadType = "Link" is an object whose payload is a Link.
        This tuple may be used as a KeyName to identify
        a specific object with the certificate wrapped key.

</p>
<a name="hashes"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7"></a><h3>7.&nbsp;
Hashes</h3>

<p>Several protocol fields use cryptographic hash functions, which must be secure against attack
        and collisions.  Because these hash functions change over time, which better ones appearing
        and old ones falling victim to attacks, it is important that a CCNx protocol implementation support
        hash agility.
</p>
<p>In this document, we suggest certain hashes (e.g. SHA-256), but a specific
        implementation may use what it deems best.  The normative <a class='info' href='#CCNMessages'>CCNx Messages<span> (</span><span class='info'>Mosko, M. and I. Solis, &ldquo;CCNx Messages in TLV Format (Internet draft),&rdquo; 2016.</span><span>)</span></a> [CCNMessages]
        specification should be taken as the definition of acceptable hash functions and uses.

</p>
<a name="signature"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.8"></a><h3>8.&nbsp;
Validation</h3>

<a name="valalg"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.8.1"></a><h3>8.1.&nbsp;
Validation Algorithm</h3>

<p>The Validator consists of a ValidationAlgorithm that specifies how to verify the message
          and a ValidationPayload containing the validation output. The ValidationAlgorithm
          section defines the type of algorithm to use and includes any necessary additional information.
          The validation is calculated from the beginning of the CCNx Message through the end of the
          ValidationAlgorithm section.  The ValidationPayload is the actual cryptographic bytes, such
        as a CRC value or an HMAC value or a signature value.
</p>
<p>
        Some Validators contain a KeyId,
        identifying the publisher authenticating the Content Object. If an Interest carries
        a KeyIdRestriction, then that KeyIdRestriction MUST exactly match the Content Object's KeyId.
</p>
<p>
        Validation Algorithms fall into three categories: MICs, MACs, and Signatures.  Validators using MIC algorithms
        do not need to provide any additional information; they may be computed and verified
        based only on the algorithm (e.g. CRC32C). MAC validators require the use of a KeyId
        identifying the secret key used by the authenticator. Because MACs are usually used between two parties that
        have already exchanged secret keys via a key exchange protocol, the KeyId may be any agreed-upon value to
        identify which key is used.  Signature
        validators use public key cryptography such as RSA, DSA, or Elliptical Curve (EC). The KeyId field in the
        ValidationAlgorithm identifies the public key used to verify the signature. A signature may optionally
        include a KeyLocator, as described above, to bundle a Key or Certificate or KeyName.  MAC and Signature
        validators may also include a SignatureTime, as described above.

</p>
<p>A PublicKeyLocator KeyName points to a Content Object with an X509 certificate
            in the payload.  In this case, the target KeyId must equal the first object's KeyId.
            The target KeyLocator must include the public key corresponding to the KeyId.
            That key must validate the target Signature.
            The payload is an X.509 certificate whose public key must match the target
            KeyLocator's key.  It must be issued by a trusted authority, preferably specifying
            the valid namespace of the key in the distinguished name.

</p>
<a name="matching"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.9"></a><h3>9.&nbsp;
Interest to Content Object matching</h3>

<p>A Content Object satisfies an Interest if and only if (a) the Content Object name, if given,
        exactly matches the Interest name, and (b) the ValidationAlgorithm KeyId of the Content Object
        exactly equals the Interest KeyIdRestriction, if given, and (c) the computed ContentObjectHash exactly equals the Interest
        ContentObjectHashRestriction, if given.
</p>
<p>The matching rules are given by this predicate, which if it evaluates true means
          the ContentObject matches the Interest.
          Ni = Name in Interest (may not be empty), Ki = KeyIdRestriction
          in the interest (may be empty), Hi = ContentObjectHashRestriction in Interest (may be empty).
          Likewise, No, Ko, Ho are those properties in the ContentObject, where No and Ko may be empty;
          Ho always exists.
          For binary relations, we use &amp; for AND and | for OR.  We use E for the EXISTS (not empty)
          operator and ! for the NOT EXISTS operator.
</p>
<p>As a special case, if the ContentObjectHashRestriction in the Interest specifies an
            unsupported hash algorithm, then no ContentObject can match the Interest so the
            system should drop the Interest and MAY send an InterestReturn to the previous hop.
            In this case, the predicate below will never get executed because the Interest is
            never forwarded.  If the system is using the optional behavior of having a different system
            calculate the hash for it, then the system may assume all hash functions are
            supported and leave it to the other system to accept or reject the Interest.
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
(!No | (Ni=No)) &amp; (!Ki | (Ki=Ko)) &amp; (!Hi | (Hi=Ho)) &amp; (E No | E Hi)
</pre></div>
<p>As one can see, there are two types of attributes one can match.  The first term
            depends on the existence of the attribute in the ContentObject while the next two terms
            depend on the existence of the attribute in the Interest.  The last term
            is the Nameless Object restriction that if a Content Object does not have a Name, then
            it must match the Interest on at least the Hash restriction.
</p>
<p>If a Content Object does not carry the ContentObjectHash
      as an expressed field, it must be calculated in network to match against. It is
      sufficient within an autonomous system to calculate a ContentObjectHash
      at a border router and carry it via trusted means within the autonomous
      system. If a Content Object ValidationAlgorithm does not have a KeyId then
      the Content Object cannot match an Interest with a KeyIdRestriction.
</p>
<a name="behavior"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.10"></a><h3>10.&nbsp;
Request/Response Protocol</h3>

<p>As an Interest moves through the network following the FIB table based on
        longest matching prefix, it leaves state at each forwarding node.  The state
      is represented in a notional Pending Interest Table (PIT).  The PIT tracks the Name, KeyIdRestriction, and ContentObjectHashRestriction
      to be matched by a Content Object.  If a second Interest arrives with the same Name and selector values,
      it may be aggregated with the existing pending Interest.  If the second Interest extends the Lifetime
      of the pending Interest, it should be forwarded to extend the life of downstream Interests.
</p>
<p>When a Content Object arrives at a Forwarder, it is matched against the Interests in the PIT.
      For each matching Interest, the Content Object is forwarded along the reverse path of that
      PIT entry and the PIT entry is removed. A Content Object that does not match any Interest in the PIT is dropped.
</p>
<p>A Forwarder may implement a Content Object cache called a Content Store.  At the
      core protocol level, the Content Store must obey similar rules as the Forwarder.
      If an Interest specifies a ContentObjectHashRestriction, the Content Store SHOULD NOT respond unless it
      has verified the hash of the Content Object. If the Interest carries a KeyIdRestriction then the Content
      Store MUST cryptographically verify the signature or not respond.

</p>
<p>
      Note that performing digital signature verification in response to an Interest
      is a vector for Denial of Service (DoS). Two cooperating nodes surrounding
      a forwarder may maliciously request and then respond with fake content to
      (a) populate the cache with fake content and (b) force the forwarder to perform
      wasteful verification operations. Implementations that support signature
      verification must consider the ramifications of such on-path attacks.

</p>
<p>TODO: Specify what to do in case of failure.
</p>
<a name="anchor3"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.11"></a><h3>11.&nbsp;
Interest Return</h3>

<p>This section describes the process whereby a network element may return an Interest message
        to a previous hop if there is an error processing the Interest. The returned Interest may be
        further processed at the previous hop or returned towards the Interest origin.
        When a node returns an Interest it indicates that the previous hop should not expect a response
        from that node for the Interest -- i.e. there is no PIT entry left at the returning node.
</p>
<p>The returned message maintains compatibility with the existing TLV packet format
        (a fixed header, optional hop-by-hop headers, and the CCNx message body). The returned Interest
        packet is modified in only two ways: </p>
<ul class="text">
<li>The PacketType is set to InterestReturn to indicate a Feedback message.
</li>
<li>The ReturnCode is set to the appropriate value to signal the reason for the return
</li>
</ul><p>

</p>
<p>The specific encodings of the Interest Return are specified in <a class='info' href='#CCNMessages'>[CCNMessages]<span> (</span><span class='info'>Mosko, M. and I. Solis, &ldquo;CCNx Messages in TLV Format (Internet draft),&rdquo; 2016.</span><span>)</span></a>.
</p>
<p>A Forwarder is not required to send any Interest Return messages.
</p>
<p>A Forwarder is not required to process any received Interest Return message.
        If a Forwarder does not process Interest Return messages, it should silently drop them.
</p>
<p>The Interest Return message does not apply to a Content Object or any other message type.
</p>
<p>An Interest Return message is a 1-hop message between peers.  It is not propagated
        multiple hops via the FIB.  An intermediate node that receives an InterestReturn may
        take corrective actions or may propagate its own InterestReturn to previous hops
        as indicated in the reverse path of a PIT entry.
</p>
<a name="MessageFormat"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.11.1"></a><h3>11.1.&nbsp;
Message Format</h3>

<p>The Interest Return message looks exactly like the original Interest message with the
        exception of the two modifications mentioned above.
        The PacketType is set to indicate the message is an InterestReturn and the reserved
        byte in the Interest header is used as a Return Code.  The numeric values for the PacketType
        and ReturnCodes are in <a class='info' href='#CCNMessages'>[CCNMessages]<span> (</span><span class='info'>Mosko, M. and I. Solis, &ldquo;CCNx Messages in TLV Format (Internet draft),&rdquo; 2016.</span><span>)</span></a>.
</p>
<a name="TypeDefinitions"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.11.2"></a><h3>11.2.&nbsp;
ReturnCode Types</h3>

<p>This section defines the InterestReturn ReturnCode introduced in this RFC.
        The numeric values used in the packet are defined in <a class='info' href='#CCNMessages'>[CCNMessages]<span> (</span><span class='info'>Mosko, M. and I. Solis, &ldquo;CCNx Messages in TLV Format (Internet draft),&rdquo; 2016.</span><span>)</span></a>.
</p><br /><hr class="insert" />
<a name="ReasonCode"></a>
<table class="full" align="center" border="0" cellpadding="2" cellspacing="2">
<col align="left"><col align="left">
<tr><th align="left">Name</th><th align="left">Description</th></tr>
<tr>
<td align="left"><a class='info' href='#NoRoute'>No Route<span> (</span><span class='info'>No Route</span><span>)</span></a></td>
<td align="left">The returning Forwarder has no route to the Interest name.</td>
</tr>
<tr>
<td align="left"><a class='info' href='#HopLimit'>HopLimit Exceeded<span> (</span><span class='info'>HopLimit Exceeded</span><span>)</span></a></td>
<td align="left">The HopLimit has decremented to 0 and need to forward the packet.</td>
</tr>
<tr>
<td align="left"><a class='info' href='#MTU'>Interest MTU too large<span> (</span><span class='info'>Interest MTU Too Large</span><span>)</span></a></td>
<td align="left">The Interest's MTU does not conform to the required minimum and would require fragmentation.</td>
</tr>
<tr>
<td align="left"><a class='info' href='#NoResources'>No Resources<span> (</span><span class='info'>No Resources</span><span>)</span></a></td>
<td align="left">The node does not have the resources to process the Interest.</td>
</tr>
<tr>
<td align="left"><a class='info' href='#PathError'>Path error<span> (</span><span class='info'>Path Error</span><span>)</span></a></td>
<td align="left">There was a transmission error when forwarding the Interest along a route (a transient error).</td>
</tr>
<tr>
<td align="left"><a class='info' href='#Prohibited'>Prohibited<span> (</span><span class='info'>Prohibited</span><span>)</span></a></td>
<td align="left">An administrative setting prohibits processing this Interest.</td>
</tr>
<tr>
<td align="left"><a class='info' href='#Congestion'>Congestion<span> (</span><span class='info'>Congestion</span><span>)</span></a></td>
<td align="left">The Interest was dropped due to congestion (a transient error).</td>
</tr>
<tr>
<td align="left"><a class='info' href='#UnsupportedHashAlgorithm'>Unsupported Content Object Hash Algorithm<span> (</span><span class='info'>Unsupported Content Object Hash Algorithm</span><span>)</span></a></td>
<td align="left">The Interest was dropped because it requested a Content Object Hash Restriction using
          a hash algorithm that cannot be computed.</td>
</tr>
<tr>
<td align="left"><a class='info' href='#MalformedInterest'>Malformed Interest<span> (</span><span class='info'>Malformed Interest</span><span>)</span></a></td>
<td align="left">The Interest was dropped because it did not correctly parse.</td>
</tr>
</table>
<br clear="all" />
<table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Table 3: Interest Return Reason Codes&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<a name="Protocol"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.11.3"></a><h3>11.3.&nbsp;
Interest Return Protocol</h3>

<p>This section describes the Forwarder behavior for the various Reason codes for Interest Return.
        A Forwarder is not required to generate any of the codes, but if it does, it must conform to
        this specification.
</p>
<p>If a Forwarder receives an Interest Return, it SHOULD take these standard corrective actions.
        A forwarder is allowed to ignore Interest Return messages, in which case its PIT entry would
        go through normal timeout processes.

        </p>
<ul class="text">
<li>Verify that the Interest Return came from a next-hop to which it actually sent the Interest.
</li>
<li>If a PIT entry for the corresponding Interest does not exist, the Forwarder should ignore the Interest Return.
</li>
<li>If a PIT entry for the corresponding Interest does exist, the Forwarder MAY do one of the following:

<ul class="text">
<li>Try a different forwarding path, if one exists, and discard the Interest Return, or
</li>
<li>Clear the PIT state and send an Interest Return along the reverse path.
</li>
</ul>

</li>
</ul><p>

</p>
<p>If a forwarder tries alternate routes, it MUST ensure that it does not use
        same same path multiple times.  For example, it could keep track of which next hops it has
        tried and not re-use them.
</p>
<p>If a forwarder tries an alternate route, it may receive a second InterestReturn, possibly of
        a different type than the first InterestReturn.  For example, node A sends an Interest to node B,
        which sends a No Route return.  Node A then tries node C, which sends a Prohibited.  Node A
        should choose what it thinks is the appropriate code to send back to its previous hop
</p>
<p>If a forwarder tries an alternate route, it should decrement the Interest Lifetime to account
        for the time spent thus far processing the Interest.
</p>
<a name="NoRoute"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.11.3.1"></a><h3>11.3.1.&nbsp;
No Route</h3>

<p>If a Forwarder receives an Interest for which it has no route, or for which the only route is
          back towards the system that sent the Interest, the Forwarder SHOULD generate a "No Route"
          Interest Return message.
</p>
<p>  How a forwarder manages the FIB table
          when it receives a No Route message is implementation dependent.
          In general, receiving a No Route Interest Return should not cause a forwarder to remove
          a route.  The dynamic routing protocol that installed the route should correct the route or
          the administrator who created a static route should correct the configuration.  A forwarder could
          suppress using that next hop for some period of time.
</p>
<a name="HopLimit"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.11.3.2"></a><h3>11.3.2.&nbsp;
HopLimit Exceeded</h3>

<p>A Forwarder MAY choose to send HopLimit Exceeded messages when it receives an Interest that must
          be forwarded off system and the HopLimit is 0.
</p>
<a name="MTU"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.11.3.3"></a><h3>11.3.3.&nbsp;
Interest MTU Too Large</h3>

<p>If a Forwarder receives an Interest whose MTU exceeds the prescribed minimum, it MAY send
          an "Interest MTU Too Large" message, or it may silently discard the Interest.
</p>
<p>If a Forwarder receives an "Interest MTU Too Large" is SHOULD NOT try alternate paths.
          It SHOULD propagate the Interest Return to its previous hops.
</p>
<a name="NoResources"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.11.3.4"></a><h3>11.3.4.&nbsp;
No Resources</h3>

<p>If a Forwarder receives an Interest and it cannot process the Interest due to lack of resources,
          it MAY send an InterestReturn.  A lack of resources could be the PIT table is too large, or some other
          capacity limit.
</p>
<a name="PathError"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.11.3.5"></a><h3>11.3.5.&nbsp;
Path Error</h3>

<p>If a forwarder detects an error forwarding an Interest, such as over a reliable link, it MAY send
          a Path Error Interest Return indicating that it was not able to send or repair a forwarding error.
</p>
<a name="Prohibited"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.11.3.6"></a><h3>11.3.6.&nbsp;
Prohibited</h3>

<p>A forwarder may have administrative policies, such as access control lists, that prohibit receiving or
          forwarding an Interest.  If a forwarder discards an Interest due to a policy, it MAY send a Prohibited
          InterestReturn to the previous hop. For example, if there is an ACL that says /parc/private can only come from
        interface e0, but the Forwarder receives one from e1, the Forwarder must have a way to return the Interest with an explanation.
</p>
<a name="Congestion"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.11.3.7"></a><h3>11.3.7.&nbsp;
Congestion</h3>

<p>If a forwarder discards an Interest due to congestion, it MAY send a Congestion InterestReturn to
          the previous hop.
</p>
<a name="UnsupportedHashAlgorithm"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.11.3.8"></a><h3>11.3.8.&nbsp;
Unsupported Content Object Hash Algorithm</h3>

<p>If a Content Object Hash Restriction specifies a hash algorithm the forwarder cannot verify,
        the Interest should not be accepted and the forwarder MAY send an InterestReturn to the previous hop.
</p>
<a name="MalformedInterest"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.11.3.9"></a><h3>11.3.9.&nbsp;
Malformed Interest</h3>

<p>If a forwarder detects a structural or syntactical error in an Interest, it SHOULD drop
        the interest and MAY send an InterestReturn to the previous hop.  This does not imply that any
        router must validate the entire structure of an Interest.
</p>
<a name="Acknowledgements"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.12"></a><h3>12.&nbsp;
Acknowledgements</h3>

<a name="IANA"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.13"></a><h3>13.&nbsp;
IANA Considerations</h3>

<p>This memo includes no request to IANA.
</p>
<p>All drafts are required to have an IANA considerations section (see <a class='info' href='#RFC5226'>Guidelines for Writing an IANA Considerations Section in RFCs<span> (</span><span class='info'>Narten, T. and H. Alvestrand, &ldquo;Guidelines for Writing an IANA Considerations Section in RFCs,&rdquo; May&nbsp;2008.</span><span>)</span></a> [RFC5226] for a guide). If the
        draft does not require IANA to do anything, the section contains an explicit statement that
        this is the case (as above). If there are no requirements for IANA, the section will be
        removed during conversion into an RFC by the RFC Editor.
</p>
<a name="Security"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.14"></a><h3>14.&nbsp;
Security Considerations</h3>

<p>The Interest Return message has no authenticator from the previous hop.  Therefore, the payload of the Interest Return
        should only be used locally to match an Interest.  A node should never forward that Interest payload as an Interest.
        It should also verify that it send the Interest in the Interest Return to that node and not allow anyone to negate
        Interest messages.
</p>
<p>If two peers require authenticated messaging, they must use an external mechanism.
</p>
<a name="rfc.references"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.15"></a><h3>15.&nbsp;
References</h3>

<a name="rfc.references1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>15.1.&nbsp;Normative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="RFC2119">[RFC2119]</a></td>
<td class="author-text">Bradner, S., &ldquo;<a href="http://www.rfc-editor.org/info/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>,&rdquo; BCP&nbsp;14, RFC&nbsp;2119, DOI&nbsp;10.17487/RFC2119, March&nbsp;1997.</td></tr>
</table>

<a name="rfc.references2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>15.2.&nbsp;Informative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="CCN">[CCN]</a></td>
<td class="author-text">PARC, Inc., &ldquo;<a href="http://www.CCNx.org">CCNx Open Source</a>,&rdquo; 2007.</td></tr>
<tr><td class="author-text" valign="top"><a name="CCNMessages">[CCNMessages]</a></td>
<td class="author-text">Mosko, M. and I. Solis, &ldquo;<a href="http://tools.ietf.org/html/draft-irtf-icnrg-ccnxmessages-01">CCNx Messages in TLV Format (Internet draft)</a>,&rdquo; 2016.</td></tr>
<tr><td class="author-text" valign="top"><a name="CCNxURI">[CCNxURI]</a></td>
<td class="author-text">Mosko, M. and C. Wood, &ldquo;<a href="http://tools.ietf.org/html/draft-mosko-icnrg-ccnxuri-03">The CCNx URI Scheme (Internet draft)</a>,&rdquo; 2016.</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3552">[RFC3552]</a></td>
<td class="author-text">Rescorla, E. and B. Korver, &ldquo;<a href="http://www.rfc-editor.org/info/rfc3552">Guidelines for Writing RFC Text on Security Considerations</a>,&rdquo; BCP&nbsp;72, RFC&nbsp;3552, DOI&nbsp;10.17487/RFC3552, July&nbsp;2003.</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC5226">[RFC5226]</a></td>
<td class="author-text">Narten, T. and H. Alvestrand, &ldquo;<a href="http://www.rfc-editor.org/info/rfc5226">Guidelines for Writing an IANA Considerations Section in RFCs</a>,&rdquo; BCP&nbsp;26, RFC&nbsp;5226, DOI&nbsp;10.17487/RFC5226, May&nbsp;2008.</td></tr>
</table>

<a name="rfc.authors"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>Authors' Addresses</h3>
<table width="99%" border="0" cellpadding="0" cellspacing="0">
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Marc Mosko</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">PARC, Inc.</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Palo Alto, California  94304</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">USA</td></tr>
<tr><td class="author" align="right">Phone:&nbsp;</td>
<td class="author-text">+01 650-812-4405</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:marc.mosko@parc.com">marc.mosko@parc.com</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Ignacio Solis</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">PARC, Inc.</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Palo Alto, California  94304</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">USA</td></tr>
<tr><td class="author" align="right">Phone:&nbsp;</td>
<td class="author-text">+01 650-812-4405</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:ignacio.solis@parc.com">ignacio.solis@parc.com</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Christopher Wood</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">PARC, Inc.</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Palo Alto, California  94304</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">USA</td></tr>
<tr><td class="author" align="right">Phone:&nbsp;</td>
<td class="author-text">+01 650-XXX-YYYY</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:christopher.wood@parc.com">christopher.wood@parc.com</a></td></tr>
</table>


</div>

  </div>
</div>

    </div>

    <div class="container">
    <footer class="site-footer">

        <div class="wrapper">

        <!-- <h2 class="footer-heading">CCNx Protocol</h2> -->
        <p>All content copyright © 2016. All rights reserved.</p>

      </div>

  </footer>
</div>


  </body>

</html>
